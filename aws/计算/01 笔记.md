# 通过密钥连接EC2
- 进入密钥所在目录
- 执行 chmod 400 test1.pem 确保密钥不公开可见
- 执行 ssh -i "test1.pem" user@公网域名 连接
- 执行 cpu 确认cpu相关信息
- yum update -y 更新本地软件
- sudo -s 提升权限
- yum install httpd git -y

# 竞价实例
平台提供实例当前时间的最低价格，客户填写可以接受的价格，只要最低价格不高于客户填写的价格，实例都可以正常运行

# EC2中的AMI(Amazon Machine Image)
通过已有的实例构建镜像，镜像包含已安装的软件和环境配置

- 服务器安装nginx
amazon-linux-extras install nginx1
-  产线服务器的80端口是否有被使用
lsof -i tcp:80
- 服务器启动nginx
systemctl start nginx
- 设置服务器自启动nginx
systemctl enable nginx

# 以用户数据创建服务器
````
#!/bin/bash
sudo su
yum update -y 
amazon-linux-extras install nginx1 -y
systemctl start nginx
systemctl enable nginx
````

# 基于快照创建镜像
快照，系统的备份节点

# EC2加载多个公用IP地址
关键在于添加多个eni

````
#!/bin/bash
sudo su
yum update -y 
amazon-linux-extras install nginx1 -y 
systemctl start nginx
systemctl enable nginx
````

1. 创建子网
EC2 网络接口 创建网络接口
基于已有的子网ID创建
2. 附加到EC2实例
3. 通过弹性IP新增公网IP，绑定到eni上

# 在Amazon Linux2上托管WordPress博客
1. 安装LAMP环境
sudo amazon-linux-extras install -y lamp-mariadb10.2-php7.2 php7.2
````
如果报错 amazon-linux-extras: command not found
需要实例与Amazon Linux2 AMI一起启动
cat /etc/system-release
````
2. 安装httpd
sudo yum install -y httpd mariadb-server
// 查看服务器程序包版本
yum info package_name
3. 启动Apache Web服务器
sudo systemctl start httpd
4. 设置httpd自启动
sudo systemctl enable httpd
5. 修改目录权限 /var/www/html默认归root用户所有，需要允许ec2-user访问此目录
建议将ec2-user添加到apache组，将apache目录的所有权赋予/var/www组，并为该组指定写入权限
sudo usermod -a -G apache ec2-user //将ec2-user添加到apache
groups //查看脚本执行结果
sudo chown -R ec2-user:apache /user/www //将/var/www及其内容的组所有权更改到apache组
sudo chmod 2775 /var/www && find /var/www -type d -exec sudo chmod 2775 {} \; // 要添加组写入权限以及设置未来子目录上的组ID 
find /var/www -type f -exec sudo chmod 0664 {}\; // 要添加组写入权限，递归地更改/var/www及其子目录权限
6. 测试使用php的环境是否正常
````
echo "<?php phpinfo();?>" > /var/www/html/phpinfo.php //创建php文件
//浏览器访问 http://ip:port/phpinfo.php
rm /var/www/html/phpinfo.php //测试完成后删除文件 
````
7. 启动数据库
````
sudo systemctl start mariadb
sudo mysql_secure_installation
````
8. 安装phpMyAdmin
````
sudo yum install php-mbstring php-xml -y
sudo systemctl restart httpd
sudo systemctl restart php-fpm
cd /var/www/html
wget https://www.phpmyadmin.net/download/phpMyAdmin-latest-all-languages.tar.gz
mkdir phpMyAdmin && tar -xvzf phpMyAdmin-latest-all-languages.tar.gz -C phpMyAdmin --strip-components 1
rm -f phpMyAdmin-latest-all-languages.tar.gz
访问：http://ip:port/phpMyAdmin
````
9. 安装WordPress
````
wget https://wordpress.org/latest.tar.gz
tar -xzf latest.tar.gz // 解压安装包到wordpress文件夹
````
10. 登录数据库
````
mysql -u root -p 
create user 'wordpress-use'@'localhost' identified by '' // 创建用户
create database 'wordpress-db'
grant all privileges on 'wordpress-db'.* to "wordpress-user"@"localhost"
flush privileges;
exit
````
11. 修改wordpress配置文件
